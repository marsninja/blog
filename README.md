# Jac Blog

A clean MkDocs blog setup with Jac syntax highlighting and interactive, runnable Jac code blocks.

## Features

- **Jac Syntax Highlighting**: Beautiful syntax highlighting for Jac code using custom Pygments and Monaco lexers
- **Interactive Code Blocks**: Run Jac code directly in the browser using Pyodide (WebAssembly)
- **Clean Design**: Built with MkDocs Material theme
- **Easy to Use**: Simple markdown-based content creation
- **Fast**: Static site generation for optimal performance

## Prerequisites

- Python 3.8 or higher
- pip (Python package installer)
- Git

## Installation

1. **Clone this repository** (if you haven't already):
   ```bash
   cd ~/blog
   ```

2. **Install all dependencies and the Jac syntax highlighter**:
   ```bash
   pip install -e .
   ```

   This will install all required dependencies (mkdocs-material, pymdown-extensions, pygments, mkdocs-video, starlette, uvicorn) and register the Jac syntax highlighter.

## Usage

### Development Server

To start the development server with interactive code execution:

```bash
python scripts/mkdocs_serve.py
```

This will start a server at `http://127.0.0.1:8000` with the necessary CORS headers for Pyodide to work.

> **Note**: The custom server (`mkdocs_serve.py`) is required for runnable code blocks to work properly because it sets up the CORS headers needed for SharedArrayBuffer support.

Alternatively, for basic preview without runnable code blocks:

```bash
mkdocs serve
```

### Building the Site

To build the static site:

```bash
mkdocs build
```

The built site will be in the `site/` directory.

### Deploying

Deploy to GitHub Pages:

```bash
mkdocs gh-deploy
```

## Writing Blog Posts

### Creating a New Post

1. Create a new markdown file in `docs/posts/`:
   ```bash
   touch docs/posts/my-new-post.md
   ```

2. Add the post to the navigation in `mkdocs.yml`:
   ```yaml
   nav:
     - Posts:
       - My New Post: posts/my-new-post.md
   ```

### Adding Jac Code Blocks

#### Static Syntax Highlighting Only

For code that just needs syntax highlighting:

````markdown
```jac
with entry {
    print("Hello, World!");
}
```
````

#### Interactive/Runnable Code Blocks

For code that users can edit and run in the browser:

````markdown
<div class="code-block">
```jac
with entry {
    print("Hello, World!");
}
```
</div>
````

This will add a "Run" button that executes the code in the browser.

#### Additional Options

You can customize the buttons shown:

- **Run only** (default): `<div class="code-block">`
- **Run and Serve**: `<div class="code-block run-serve">`
- **Serve only**: `<div class="code-block serve-only">`

Example:

````markdown
<div class="code-block run-serve">
```jac
with entry {
    print("This has both Run and Serve buttons!");
}
```
</div>
````

## Project Structure

```
~/blog/
├── docs/                          # Documentation source files
│   ├── index.md                   # Homepage
│   ├── about.md                   # About page
│   ├── posts/                     # Blog posts
│   │   └── welcome.md            # Example post
│   ├── js/                        # JavaScript files
│   │   ├── jac.monarch.js        # Monaco Editor Jac syntax
│   │   ├── run-code.js           # Interactive code execution
│   │   └── pyodide-worker.js     # Pyodide web worker
│   ├── playground/                # Playground resources
│   │   ├── language-configuration.json
│   │   └── jaclang.zip           # (Generated by build hook)
│   ├── extra.css                  # Custom CSS styling
│   └── assets/                    # Images and other assets
├── scripts/                       # Build and serve scripts
│   ├── handle_jac_compile_data.py # Build hook for Jac compiler
│   └── mkdocs_serve.py           # Custom dev server
├── overrides/                     # Theme overrides (optional)
├── jac_syntax_highlighter.py     # Pygments lexer for Jac
├── mkdocs.yml                     # MkDocs configuration
└── README.md                      # This file
```

## How It Works

### Syntax Highlighting

The blog uses two lexers for syntax highlighting:

1. **Pygments Lexer** (`jac_syntax_highlighter.py`): Used for server-side static code highlighting during build
2. **Monaco Monarch Lexer** (`docs/js/jac.monarch.js`): Used for client-side syntax highlighting in the interactive code editor

### Interactive Code Execution

The runnable code blocks use:

1. **Pyodide**: A Python runtime compiled to WebAssembly that runs in the browser
2. **Monaco Editor**: The same code editor that powers VS Code
3. **Web Workers**: For isolated code execution without blocking the UI
4. **SharedArrayBuffer**: For synchronous input handling (requires special CORS headers)

When you click "Run":
1. The code is loaded into Monaco Editor
2. A web worker initializes Pyodide and loads the Jac compiler
3. The code is executed in the browser
4. Output is streamed back to the page in real-time

## Customization

### Changing Theme Colors

Edit the `palette` section in `mkdocs.yml`:

```yaml
theme:
  palette:
    scheme: slate        # Use 'default' for light mode
    primary: black       # Primary color
    accent: orange       # Accent color
```

### Adding Social Links

Edit the `extra.social` section in `mkdocs.yml`:

```yaml
extra:
  social:
    - icon: fontawesome/brands/github
      link: https://github.com/yourusername
    - icon: fontawesome/brands/twitter
      link: https://twitter.com/yourusername
```

### Custom CSS

Add your custom styles to `docs/extra.css`.

## Troubleshooting

### Runnable code blocks not working

- Make sure you're using the custom server: `python scripts/mkdocs_serve.py`
- The custom server sets CORS headers required for SharedArrayBuffer
- Check browser console for errors

### Syntax highlighting not working

- Ensure `jac_syntax_highlighter.py` is installed properly
- Try rebuilding: `mkdocs build --clean`

### Build hook errors

- Make sure you have the Jac compiler installed
- The hook tries to create `docs/playground/jaclang.zip` from your Jac installation
- If you don't have Jac installed, comment out the hook in `mkdocs.yml`

## Dependencies

Core dependencies:
- `mkdocs-material`: Material theme for MkDocs
- `pymdown-extensions`: Markdown extensions for code highlighting
- `pygments`: Syntax highlighting library
- `starlette`: ASGI framework for custom server
- `uvicorn`: ASGI server

Optional dependencies:
- `mkdocs-video`: Video embedding support

## License

[Add your license here]


## Contributing

Contributions are welcome! Feel free to open issues or submit pull requests.

## Acknowledgments

- Built with [MkDocs](https://www.mkdocs.org/) and [Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)
- Interactive code execution powered by [Pyodide](https://pyodide.org/)
- Code editor powered by [Monaco Editor](https://microsoft.github.io/monaco-editor/)
- Based on the excellent documentation setup from the [Jaseci project](https://github.com/Jaseci-Labs/jaseci)
